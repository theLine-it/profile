;/*FB_PKG_DELIM*/

__d("WAWebWamEnumWebContactListStartNewChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({CONTACT:1,GROUP:2,CONTACTLESS:3});f.WEB_CONTACT_LIST_START_NEW_CHAT_TYPE=a}),66);
__d("WAWebWebContactListStartNewChatWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebContactListStartNewChatType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebContactListStartNewChat:[4560,{webContactListStartNewChatSearch:[1,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],webContactListStartNewChatType:[2,d("WAWebWamEnumWebContactListStartNewChatType").WEB_CONTACT_LIST_START_NEW_CHAT_TYPE]},[1,1,1],"regular"]},{WebContactListStartNewChat:[]});g.WebContactListStartNewChatWamEvent=a}),98);
__d("WAWebNewChatMetricUtils",["WATimeUtils","WAWebChatConstants","WAWebChatThreadLogging","WAWebWebContactListStartNewChatWamEvent"],(function(a,b,c,d,e,f,g){function a(a){var b=a.isSearchResult;a=a.chatType;new(d("WAWebWebContactListStartNewChatWamEvent").WebContactListStartNewChatWamEvent)({webContactListStartNewChatSearch:b,webContactListStartNewChatType:a}).commit()}function b(a){var b=!(a.msgs.some(function(a){return a.isRealMessage()})||a.endOfHistoryTransferType===d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE);b&&d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"viaContactlessChats",ts:d("WATimeUtils").unixTime(),chatId:a.id,boolValue:!0}])}g.logContactListStartNewChatAction=a;g.logInitiatedContactlessChat=b}),98);
__d("WAWebNewChatDrawer.react",["fbt","WALogger","WAWebAccountTakeOverBanner.react","WAWebApiContact","WAWebBox.react","WAWebCellBorder.react","WAWebChatContactList.react","WAWebChatListSearch.react","WAWebCmd","WAWebCommunityGatingUtils","WAWebComposeBoxActions","WAWebContactCollection","WAWebContactGetters","WAWebContactManagementGating","WAWebContactlessChatUtils","WAWebDefaultAddProfilePicture.react","WAWebDrawer.react","WAWebDrawerBody.react","WAWebDrawerHeader.react","WAWebDrawerManager","WAWebDrawerViewType","WAWebEmptyState.react","WAWebFbtCommon","WAWebFindChatAction","WAWebFlatListController","WAWebFocusIndicator","WAWebL10N","WAWebLidContactsGatingUtils","WAWebNewChatMetricUtils","WAWebPhoneNumberSearch","WAWebQueryExistsJob","WAWebUIRefreshGatingUtils","WAWebUISpacing","WAWebUnknownContactSection.react","WAWebUseContactManagementAvailability","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWDSCell.react","WAWebWDSText.react","WAWebWamEnumWebContactListStartNewChatType","WAWebWidFactory","asyncToGeneratorRuntime","react","useLazyRef","useWAWebDebouncedCallback","useWAWebForceUpdate","useWAWebListener","useWAWebStableCallback","useWAWebUnknownContact"],(function(a,b,c,d,e,f,g,h){var i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryUsernameExists failed with error:",""]);k=function(){return a};return a}e=j||d("react");var l=i||(i=c("react")),m=e.useCallback,n=e.useRef,o=e.useState,p={atoBanner:{paddingTop:"x1cnzs8",paddingBottom:"x1a8lsjc",marginTop:"x1kgmq87",marginBottom:"xmgb6t1",backgroundColor:"x150wa6m",zIndex:"xyw6214",position:"x1n2onr6",$$css:!0}},q=3;function r(a){var b=a.image,e=a.onClick;a=a.primary;var f=h._(/*BTDS*/"__JHASH__vDb1gwdkYRB__JHASH__",[h._param("item-title",a.toString())]);return l.jsxs(d("WAWebBox.react").Box,{padding:d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()?[0,8]:null,children:[l.jsx(d("WAWebWDSCell.react").WDSCell,{size:"medium",material:d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled(),detailLeft:b,detailLeftXStyle:[d("WAWebUISpacing").uiPadding.start13],primary:l.jsxs(d("WAWebWDSText.react").WDSTextTitle,{children:[a," "]}),onClick:e,ariaLabel:f}),!d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()&&l.jsx(c("WAWebCellBorder.react"),{})]})}r.displayName=r.name+" [from "+f.id+"]";e=l.forwardRef(a);function a(a,e){a=babelHelpers["extends"]({},a);var f=a.title,g=a.onBack,i=a.onClick,j=a.onNewGroup,s=a.onNewCommunity,t=a.onNewContact;a=a.viewType;var u=o(""),v=u[0],w=u[1];u=o(null);var x=u[0],y=u[1];u=n();var z=n(),A=n(),B=Boolean(v),C=x!=null?d("WAWebContactCollection").ContactCollection.get(x):null;x=c("useLazyRef")(function(){return new(c("WAWebFlatListController"))()});var D=d("WAWebLidContactsGatingUtils").isLidContactOneOnOneChatEnabled(),E=d("WAWebUsernameGatingUtils").usernameContactlessChatEnabled(),F=h._(/*BTDS*/"__JHASH__UGA_7UxgMl-__JHASH__"),G=d("useWAWebForceUpdate").useForceUpdateDONOTUSE();d("useWAWebListener").useListener(d("WAWebContactCollection").ContactCollection,"change:name",G);G=d("WAWebUseContactManagementAvailability").useAccountIntegrityState();E?F=h._(/*BTDS*/"__JHASH__9_YtmuZHuHu__JHASH__"):F=c("WAWebFbtCommon")("Search name or number");var H=m(function(b){d("WAWebContactCollection").ContactCollection.ensureSorted();b=typeof b==="string"?b:v;if(!b)return d("WAWebContactCollection").ContactCollection.getFilteredContacts({showMe:!!b,includeLidContacts:D});var a=d("WAWebContactCollection").ContactCollection.getFilteredContacts({showMe:!!b,includeLidContacts:D}).concat(d("WAWebContactCollection").ContactCollection.filter(function(a){return a.name&&!d("WAWebContactGetters").getIsMe(a)&&!d("WAWebContactGetters").getIsPSA(a)&&!d("WAWebContactGetters").getIsWAContact(a)&&!d("WAWebContactGetters").getIsNewsletter(a)})),e=c("WAWebL10N").accentFold(b),f=d("WAWebPhoneNumberSearch").numberSearch(e);return a.filter(function(a){return a.searchMatch(e,f)})},[v,D]),I=H(),J=c("useWAWebUnknownContact")({phoneNumber:v,shouldStartSearch:I.length===0}),K=J.unknownContactInfo,L=J.loading,M=J.error;J=J.onRetry;var N=c("useWAWebDebouncedCallback")(function(a){return w(a)},100),O=m(function(a){A.current=a,E&&a.length>=q&&d("WAWebQueryExistsJob").queryUsernameExists(a).then(function(b){if(A.current===a){y((b=b==null?void 0:b.wid)!=null?b:null);N(a)}})["catch"](function(b){A.current===a&&(y(null),N(a)),d("WALogger").ERROR(k(),b).devConsole(b)}),A.current=a,N(a)},[E,N]),P=m(function(a,b,d){c("WAWebFocusIndicator").shouldIndicateFocus(),i(a,b,void 0,d)},[i]),Q=c("useWAWebStableCallback")(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a.preventDefault();a.stopPropagation();d("WAWebDrawerManager").DrawerManager.closeDrawerLeft();a=(a=K==null?void 0:K.chat)!=null?a:yield d("WAWebFindChatAction").findOrCreateLatestChat(b,"newChatFlow");b=d("WAWebCmd").Cmd.openChatFromUnread(a);if(!b)return;d("WAWebNewChatMetricUtils").logInitiatedContactlessChat(a);d("WAWebNewChatMetricUtils").logContactListStartNewChatAction({chatType:d("WAWebWamEnumWebContactListStartNewChatType").WEB_CONTACT_LIST_START_NEW_CHAT_TYPE.CONTACTLESS,isSearchResult:!0});d("WAWebComposeBoxActions").ComposeBoxActions.focus(a)});return function(b,c){return a.apply(this,arguments)}}()),R=m(function(a){a.preventDefault();a.stopPropagation();if(C){P(a,C,"username_contactless_search");return}if(!B){var b=d("WAWebContactCollection").ContactCollection.assertGet(d("WAWebUserPrefsMeUser").getMeUser());P(a,b);return}b=H(A.current)[0];if(b){P(a,b);return}(K==null?void 0:K.wid)&&void Q(a,K.wid)},[C,B,H,K==null?void 0:K.wid,P,Q]),S=[];if(!v){var T=l.jsx(d("WAWebDefaultAddProfilePicture.react").DefaultAddProfilePicture,{directional:!0,type:"group",size:48});S.push({image:T,id:h._(/*BTDS*/"__JHASH__6EroHqWSWmZ__JHASH__"),onClick:j});if(d("WAWebContactManagementGating").contactManagementEnabled()){T=l.jsx(d("WAWebDefaultAddProfilePicture.react").DefaultAddProfilePicture,{directional:!0,type:"contact",size:48});j=h._(/*BTDS*/"__JHASH__UtaS3T1Ecyz__JHASH__");S.push({image:T,id:j,onClick:t})}if(d("WAWebCommunityGatingUtils").communitiesCreationEnabled()){T=l.jsx(d("WAWebDefaultAddProfilePicture.react").DefaultAddProfilePicture,{directional:!0,type:"community",size:48});S.push({image:T,id:h._(/*BTDS*/"__JHASH__KIkd5AW9_IK__JHASH__"),onClick:s})}}j=null;G===d("WAWebUseContactManagementAvailability").AccountIntegrityState.TIMELOCK&&(j=l.jsx(d("WAWebAccountTakeOverBanner.react").AccountTakeOverBanner,{entryPoint:"new-chat",xstyle:p.atoBanner}));t=function(a){if(a!=null){var b=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a.id));b=b!=null?d("WAWebContactCollection").ContactCollection.get(b):null;if((b==null||!I.includes(b))&&!I.includes(a))return[a]}return};T=t(C);I.length===0&&!C&&!!v?L?s=l.jsx(d("WAWebEmptyState.react").SearchingNonContact,{}):M?s=l.jsx(d("WAWebEmptyState.react").SearchingNonContactError,{error:d("WAWebContactlessChatUtils").getErrorStr(M),onClick:J}):K?s=l.jsx(c("WAWebUnknownContactSection.react"),{contactInfo:K,onUnknownContactClick:Q}):s=l.jsx(d("WAWebEmptyState.react").SearchWithKeyword,{keyword:v}):s=l.jsx(c("WAWebChatContactList.react"),{ref:z,contacts:I,flatListController:x.current,usernameContacts:T,onClick:i,showMe:!B,showBot:!B,showPersonGroupDivisionHeader:!0,showHeaderSpinner:G===d("WAWebUseContactManagementAvailability").AccountIntegrityState.PENDING});t=a===c("WAWebDrawerViewType").FLYOUT?d("WAWebDrawerHeader.react").DRAWER_HEADER_TYPE.FLYOUT:d("WAWebDrawerHeader.react").DRAWER_HEADER_TYPE.SMALL;return l.jsxs(c("WAWebDrawer.react"),{ref:e,testid:void 0,viewType:a,children:[l.jsx(d("WAWebDrawerHeader.react").DrawerHeader,{title:f,type:t,onBack:a===c("WAWebDrawerViewType").FLYOUT?void 0:g}),l.jsx(d("WAWebChatListSearch.react").ListSearch,{ref:u,onSearch:O,onEnter:R,placeholder:F,type:d("WAWebChatListSearch.react").ListSearchType.NEW_CHAT_CONTACT_SEARCH,loading:L,showPlaceholderUntilType:!0,focusOnMount:!0}),l.jsxs(c("WAWebDrawerBody.react"),{flatListControllers:[x.current],backgroundColor:"default",children:[S.map(function(a,b){var c=a.image,d=a.id;a=a.onClick;return l.jsx(r,{image:c,primary:d,onClick:a},b)}),j,s]})]},"contact-modal")}a.displayName=a.name+" [from "+f.id+"]";a=e;g["default"]=a}),226);
__d("WAWebNewChatFlowTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NewChatDrawer","NewCommunityFlow","NewGroupFlow","NewContactFlow"]);f.NewChatFlowStep=a}),66);
__d("WAWebNewChatFlow.react",["fbt","WAWebChatGetters","WAWebCmd","WAWebCommunityCreationFlowMetricUtils","WAWebComposeBoxActions","WAWebContactCollection","WAWebContactEditDrawer.react","WAWebContactEditUtils","WAWebContactGetters","WAWebContactLogging","WAWebDrawerViewType","WAWebFindChatAction","WAWebMessageYourselfMetricUtils","WAWebModal.react","WAWebModalManager","WAWebNativeContactsNuxPopup.react","WAWebNewChatDrawer.react","WAWebNewChatFlowTypes","WAWebNewChatMetricUtils","WAWebNewCommunityInfoDrawer.react","WAWebNewGroupFlowLoadable","WAWebUIRefreshGatingUtils","WAWebWamEnumCommunityCreationCurrentScreenType","WAWebWamEnumCommunityCreationEntrypointType","WAWebWamEnumWebContactListStartNewChatType","asyncToGeneratorRuntime","react","useWAWebFlow","useWAWebListener"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react"),l=(i||(i=d("react"))).useRef;e=k.forwardRef(a);function a(a,e){var f=a.onEnd,g=a.viewType;d("WAWebContactCollection").ContactCollection.ensureSorted();var i=l();a=d("useWAWebFlow").useFlow(d("WAWebNewChatFlowTypes").NewChatFlowStep.NewChatDrawer,{transitions:d("useWAWebFlow").FlowTransitions.DrawerRight,onEnd:f});f=a[0];var j=a[1];a=function(){j.end()};d("useWAWebListener").useListener(d("WAWebCmd").Cmd,"end_flow",a);var m=function(a,b,c){c===void 0&&(c=!1);var e={};a.isEnterprise&&a.privacyMode!=null&&(e.nextPrivacyMode=a.privacyMode);void d("WAWebFindChatAction").findOrCreateLatestChat(a.id,(b=b)!=null?b:"newChatFlow",e).then(function(b){d("WAWebCmd").Cmd.openChatFromUnread(b).then(function(e){if(!e)return;e=d("WAWebChatGetters").getIsGroup(b)?d("WAWebWamEnumWebContactListStartNewChatType").WEB_CONTACT_LIST_START_NEW_CHAT_TYPE.GROUP:d("WAWebWamEnumWebContactListStartNewChatType").WEB_CONTACT_LIST_START_NEW_CHAT_TYPE.CONTACT;d("WAWebNewChatMetricUtils").logContactListStartNewChatAction({chatType:e,isSearchResult:d("WAWebChatGetters").getIsGroup(b)||c});d("WAWebContactGetters").getIsMe(a)&&d("WAWebMessageYourselfMetricUtils").UiMessageYourselfNewChatAction.logMessageYourselfOpenedEvent(b,c);d("WAWebComposeBoxActions").ComposeBoxActions.focus(b)})})};a=function(a,b,c,d){c===void 0&&(c=!1),m(b,d,c),j.end()};var n=function(a){a=d("WAWebContactCollection").ContactCollection.assertGet(a);m(a,"createContact");g===c("WAWebDrawerViewType").FLYOUT||d("WAWebUIRefreshGatingUtils").newChatCreationModalEnabled()?d("WAWebModalManager").ModalManager.close():j.end()},o=function(a){g===c("WAWebDrawerViewType").FLYOUT||d("WAWebUIRefreshGatingUtils").newChatCreationModalEnabled()?(j.end(),d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebModal.react").Modal,{type:d("WAWebModal.react").ModalTheme.Tower,children:k.jsx(d("WAWebNewGroupFlowLoadable").NewGroupFlowLoadable,{onCreateGroup:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a,d("WAWebModalManager").ModalManager.close()});return function(b){return a.apply(this,arguments)}}(),onEnd:function(){d("WAWebModalManager").ModalManager.close()},viewType:c("WAWebDrawerViewType").MODAL})}))):j.push(d("WAWebNewChatFlowTypes").NewChatFlowStep.NewGroupFlow)},p=function(a){g===c("WAWebDrawerViewType").FLYOUT||d("WAWebUIRefreshGatingUtils").newChatCreationModalEnabled()?(j.end(),d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebModal.react").Modal,{type:d("WAWebModal.react").ModalTheme.Tower,children:k.jsx(c("WAWebNewCommunityInfoDrawer.react"),{onCreateCommunity:function(){d("WAWebModalManager").ModalManager.close()},viewType:c("WAWebDrawerViewType").MODAL,onBack:function(){d("WAWebModalManager").ModalManager.close()}})}))):j.push(d("WAWebNewChatFlowTypes").NewChatFlowStep.NewCommunityFlow),d("WAWebCommunityCreationFlowMetricUtils").UiCommunityCreationAction.startSession(d("WAWebWamEnumCommunityCreationEntrypointType").COMMUNITY_CREATION_ENTRYPOINT_TYPE.CHATS_TAB),d("WAWebCommunityCreationFlowMetricUtils").UiCommunityCreationAction.enter(d("WAWebWamEnumCommunityCreationCurrentScreenType").COMMUNITY_CREATION_CURRENT_SCREEN_TYPE.CHATS_TAB)},q=function(a){if(d("WAWebContactEditUtils").shouldShowNativeContactsNux()){d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebNativeContactsNuxPopup.react").NativeContactsNuxPopup,{source:d("WAWebContactLogging").ContactSourceType.NewChat}));return}g===c("WAWebDrawerViewType").FLYOUT||d("WAWebUIRefreshGatingUtils").newChatCreationModalEnabled()?(j.end(),d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebModal.react").Modal,{type:d("WAWebModal.react").ModalTheme.Tower,children:k.jsx(c("WAWebContactEditDrawer.react"),{ref:i,origin:d("WAWebContactLogging").ContactSourceType.NewChat,onSave:n,viewType:c("WAWebDrawerViewType").MODAL,onCancel:function(){d("WAWebModalManager").ModalManager.close()}})}))):j.push(d("WAWebNewChatFlowTypes").NewChatFlowStep.NewContactFlow)},r=function(){if(j.step===d("WAWebNewChatFlowTypes").NewChatFlowStep.NewContactFlow){var a;(a=i.current)==null?void 0:a.handleDismiss()}j.pop()};if(j.step==null)return null;var s=null;switch(j.step){case d("WAWebNewChatFlowTypes").NewChatFlowStep.NewChatDrawer:s=k.jsx(c("WAWebNewChatDrawer.react"),{title:h._(/*BTDS*/"__JHASH__G__8-ng2r4N__JHASH__"),onBack:function(){return j.end()},onClick:a,onNewGroup:o,onNewCommunity:p,onNewContact:q,viewType:(a=g)!=null?a:c("WAWebDrawerViewType").DRAWER});break;case d("WAWebNewChatFlowTypes").NewChatFlowStep.NewGroupFlow:s=k.jsx(d("WAWebNewGroupFlowLoadable").NewGroupFlowLoadable,{onCreateGroup:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a,j.end()});return function(b){return a.apply(this,arguments)}}(),onEnd:j.pop,viewType:(o=g)!=null?o:c("WAWebDrawerViewType").DRAWER});break;case d("WAWebNewChatFlowTypes").NewChatFlowStep.NewCommunityFlow:s=k.jsx(c("WAWebNewCommunityInfoDrawer.react"),{onBack:j.pop,onCreateCommunity:g===c("WAWebDrawerViewType").MODAL?j.end:void 0,viewType:(p=g)!=null?p:c("WAWebDrawerViewType").DRAWER});break;case d("WAWebNewChatFlowTypes").NewChatFlowStep.NewContactFlow:s=k.jsx(c("WAWebContactEditDrawer.react"),{ref:i,origin:d("WAWebContactLogging").ContactSourceType.NewChat,onSave:n,onBack:j.pop,viewType:(q=g)!=null?q:c("WAWebDrawerViewType").DRAWER});break}return k.jsx(f,{ref:e,flow:j,requestDismiss:r,children:s})}a.displayName=a.name+" [from "+f.id+"]";a=e;g["default"]=a}),226);